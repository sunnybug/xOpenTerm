# xOpenTerm UI 设计原则检查报告

基于以下七条原则对项目界面与交互进行了检查，并已对发现的问题做了相应修改或记录建议。

---

## 1. 可见性（Visibility）

**已具备：**
- 主窗口：顶栏菜单（设置、帮助）、左侧 Tab（服务器 / 远程文件）、树形列表与远程文件列表、标签页与关闭按钮，结构清晰。
- 列表列（名称、大小、类型）与树节点图标（分组/SSH/RDP）能明确传达当前状态与可操作对象。
- 更新窗口：根据检查结果显示“正在检查…”“发现新版本”“已是最新版本”“检查更新失败”，并控制“前往下载”“重试”等按钮的显示，状态可见。

**建议：**
- 远程文件列表在请求中时可考虑增加加载中指示（如禁用列表或显示“加载中…”），避免用户误以为无数据。

---

## 2. 反馈（Feedback）

**已具备：**
- 表单校验：节点/凭证/跳板机编辑中，必填项为空时用 `MessageBox` 提示（如“请填写主机”“请输入名称”“请选择登录凭证”）。
- 测试连接：SSH/跳板机测试后明确提示“连接成功”或“连接失败”。
- 错误反馈：PuTTY 启动失败、RDP 解析失败、会话错误等均通过 `MessageBox` 或终端内红色文案提示。
- 设置保存：字体设置确定后主窗口立即应用新字体，视觉上即时有反馈。
- 更新检查：成功/失败/已是最新/发现新版本均有文案与按钮状态变化。

**一致性：**
- 各编辑窗口保存后通过关闭对话框并刷新列表/树的方式反馈“已保存”，与用户预期一致。

---

## 3. 约束（Constraints）

**已具备：**
- 登录凭证 / 隧道管理：未选中项时“编辑”“删除”按钮 `IsEnabled="False"`，避免无效操作。
- 认证方式与表单项：根据“密码/私钥/凭证/Agent”切换显示对应输入区（密码、私钥路径、凭证下拉等），隐藏不适用项，减少误填。
- 节点类型与配置：分组仅显示名称；SSH 显示主机/端口/认证/跳板机/测试连接等；RDP 显示主机/端口/用户名/密码；本地显示协议，通过可见性约束引导正确配置。

**本次修改：**
- 节点编辑、跳板机编辑中的端口输入框增加 `MaxLength="5"`，限制为最多 5 位数字（端口 1–65535），与约束原则一致。

**建议：**
- 保存时若端口超出 1–65535，可增加校验并提示“端口应在 1–65535 之间”，进一步预防错误。

---

## 4. 一致性（Consistency）

**已具备：**
- 各对话框均使用“取消”+ `IsCancel="True"`，支持 Esc 关闭；主操作多为“保存”或“确定”在左、取消在右。
- 设置窗口“确定”为 `IsDefault="True"`，支持 Enter 确认。
- 凭证与跳板机删除均采用“确定删除 xxx？”的 Yes/No 确认，文案与交互一致。

**本次修改：**
- 主窗口树节点“删除”“删除（含子节点）”增加与凭证/跳板机一致的确认对话框，避免误删且交互一致。
- 节点编辑窗口“保存”设为 `IsDefault="True"`，与设置窗口一致，Enter 即可保存。

---

## 5. 贴合用户心智模型（Mapping）

**已具备：**
- 双击节点打开连接、右键弹出上下文菜单、标签页上的 × 关闭该连接，符合常见终端/文件管理类软件习惯。
- 树形结构展开/折叠与分组/主机层级一致；远程文件列表中双击进入目录或打开文件，符合“文件夹”心智模型。
- “测试连接”紧贴 SSH/跳板机配置，符合“先配置再验证”的预期。

---

## 6. 可容错性（Error Prevention）

**已具备：**
- 凭证删除、跳板机删除前均有“确定删除「xxx」？”确认，防止误点导致数据丢失。

**本次修改：**
- 主窗口“删除”节点：增加“确定删除节点「xxx」？”确认（`MessageBoxButton.YesNo`）。
- 主窗口“删除（含子节点）”分组：增加“确定删除分组「xxx」及全部子节点？此操作不可恢复。”确认（`MessageBoxImage.Warning`），在不可恢复操作前再次确认，符合可容错性原则。

---

## 7. 清晰的恢复机制（Affordance）

**已具备：**
- 所有编辑对话框均可通过“取消”或 Esc 放弃本次修改并关闭，不写入存储。
- 删除类操作均有“是/否”选择，用户可在确认前选择“否”以恢复/保持当前状态。

**说明：**
- 删除节点/凭证/跳板机后当前版本无“撤销”功能；通过上述确认步骤，用户至少有机会在点击前中止，降低误操作带来的不可恢复感。若后续需要，可考虑在删除前将数据放入“回收”或提供短暂撤销（如 5 秒内可恢复）。

---

## 修改项汇总

| 文件 | 修改内容 |
|------|----------|
| `MainWindow.xaml.cs` | 删除节点、删除分组（含子节点）前增加确认对话框；分组删除提取 `RemoveNodeRecursive` 仅执行一次确认。 |
| `NodeEditWindow.xaml` | “保存”按钮设置 `IsDefault="True"`；端口 `PortBox` 设置 `MaxLength="5"`。 |
| `TunnelEditWindow.xaml` | 端口 `PortBox` 设置 `MaxLength="5"`。 |

以上修改均已在代码中完成，可直接通过编译与功能测试验证。
